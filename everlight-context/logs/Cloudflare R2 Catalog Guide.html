<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Cloudflare R2 Catalog Guide</title>
</head>
<body>
<hr />
<p>conversation_id: "68ad2f7e-baf4-8332-837f-139894036f95"
title: "Cloudflare R2 Catalog Guide"
accounts: ["Account1_exports"]
models: []
tags: []
message_count: 19</p>
<hr />
<h1 id="cloudflare-r2-catalog-guide">Cloudflare R2 Catalog Guide</h1>
<h2 id="user">â€” user</h2>
<h2 id="system">â€” system</h2>
<h2 id="system_1">â€” system</h2>
<h2 id="2025-08-26t035236344000z-user">2025-08-26T03:52:36.344000Z â€” user</h2>
<p>https://catalog.cloudflarestorage.com/74b94b7ffc15701b77e53f81bea03813/omniversal-s3</p>
<p>What is this and how do I use it</p>
<h2 id="2025-08-26t035238545438z-assistant">2025-08-26T03:52:38.545438Z â€” assistant</h2>
<h2 id="2025-08-26t035239011554z-system">2025-08-26T03:52:39.011554Z â€” system</h2>
<h2 id="2025-08-26t035239041465z-system">2025-08-26T03:52:39.041465Z â€” system</h2>
<h2 id="2025-08-26t035239052169z-assistant">2025-08-26T03:52:39.052169Z â€” assistant</h2>
<h2 id="2025-08-26t035239155710z-assistant">2025-08-26T03:52:39.155710Z â€” assistant</h2>
<h2 id="2025-08-26t035242086188z-tool">2025-08-26T03:52:42.086188Z â€” tool</h2>
<h2 id="2025-08-26t035242233159z-assistant">2025-08-26T03:52:42.233159Z â€” assistant</h2>
<h2 id="2025-08-26t035248424059z-tool">2025-08-26T03:52:48.424059Z â€” tool</h2>
<h2 id="2025-08-26t035249349550z-assistant">2025-08-26T03:52:49.349550Z â€” assistant</h2>
<p>Short version: that URL is the <strong>Cloudflare R2 Data Catalog</strong> endpoint for your account and catalog named <strong><code>omniversal-s3</code></strong>. R2 Data Catalog turns an R2 bucket into an <strong>Apache Iceberg</strong> catalog so engines like <strong>Spark/Databricks, PyIceberg, Snowflake (via external table/connector)</strong> can discover tables and query data directly in-placeâ€”no copying to a separate warehouse. îˆ€citeîˆ‚turn1search0îˆ‚turn1search2îˆ</p>
<p>Hereâ€™s how to use it (quick start):</p>
<p>1) <strong>Enable the catalog (one-time)</strong>
- In Cloudflare Dashboard: R2 â†’ pick your bucket â†’ <strong>Settings â†’ R2 Data Catalog â†’ Enable</strong>. Note the <strong>Catalog URI</strong> (it looks like your link) and <strong>Warehouse name</strong>. îˆ€citeîˆ‚turn1search8îˆ</p>
<p>2) <strong>Create an API token</strong>
- Create a Cloudflare API token with R2 Data Catalog permissions; youâ€™ll use it as a <strong>Bearer</strong> token to talk to the catalog. The â€œGetting startedâ€ guide walks through token creation. îˆ€citeîˆ‚turn1search11îˆ</p>
<p>3) <strong>Connect from your tool of choice</strong></p>
<ul>
<li><strong>Python (PyIceberg)</strong>
  ```python
  from pyiceberg.catalog import load_catalog</li>
</ul>
<p>catalog = load_catalog(
      "omniversal",
      **{
        "uri": "https://catalog.cloudflarestorage.com/74b94b7ffc15701b77e53f81bea03813/omniversal-s3",
        "credential": "YOUR_API_TOKEN",  # Cloudflare API token
      }
  )</p>
<p># List namespaces and tables
  print(catalog.list_namespaces())
  print(catalog.list_tables(("default",)))</p>
<p># Create a table (example schema)
  from pyiceberg.schema import Schema
  from pyiceberg.types import NestedField, StringType, LongType</p>
<p>schema = Schema(
      NestedField(1, "id", LongType(), required=True),
      NestedField(2, "name", StringType()),
  )
  catalog.create_table(("default", "people"), schema=schema)
  ```
  (Flow per Cloudflareâ€™s â€œGetting started with Data Catalogâ€.) îˆ€citeîˆ‚turn1search11îˆ</p>
<ul>
<li><strong>Apache Spark</strong>
  ```sql
  -- In Spark (Scala/PySpark), configure an Iceberg REST catalog
  SET spark.sql.catalog.omniversal = org.apache.iceberg.spark.SparkCatalog;
  SET spark.sql.catalog.omniversal.type = rest;
  SET spark.sql.catalog.omniversal.uri = https://catalog.cloudflarestorage.com/74b94b7ffc15701b77e53f81bea03813/omniversal-s3;
  SET spark.sql.catalog.omniversal.oauth2.token = YOUR_API_TOKEN;</li>
</ul>
<p>-- Now use it
  SHOW NAMESPACES IN omniversal;
  CREATE NAMESPACE omniversal.default;
  CREATE TABLE omniversal.default.events (id BIGINT, ts TIMESTAMP, data STRING);
  INSERT INTO omniversal.default.events VALUES (1, current_timestamp(), 'hello');
  SELECT * FROM omniversal.default.events;
  ```
  (R2 Data Catalog exposes the <strong>Iceberg REST</strong> interface that Spark understands.) îˆ€citeîˆ‚turn1search0îˆ</p>
<ul>
<li><strong>Databricks / Unity Catalog external location</strong>
  Use Databricksâ€™ instructions to connect to <strong>Cloudflare R2</strong> storage (S3-compatible) for data and point Iceberg <strong>catalog</strong> to the Cloudflare endpoint above. îˆ€citeîˆ‚turn1search7îˆ</li>
</ul>
<p>4) <strong>Pricing note</strong>
- The Data Catalog is (as of now) in <strong>public beta</strong> with no extra charge beyond normal R2 storage/ops; Cloudflare will give notice before charging. îˆ€citeîˆ‚turn1search19îˆ</p>
<p>Why this matters for you
- You can keep datasets in your R2 bucket and <strong>query them where they live</strong> (Spark/Python), manage tables/versions/partitions with Iceberg, and avoid egress fees. îˆ€citeîˆ‚turn1search2îˆ</p>
<p>If you want, tell me which bucket you enabled and what engine you want to use (Spark, PyIceberg, Snowflake). Iâ€™ll hand you the exact, copy-paste config for that stack.</p>
<h2 id="2025-08-26t035255507844z-assistant">2025-08-26T03:52:55.507844Z â€” assistant</h2>
<h2 id="2025-08-26t035300186822z-assistant">2025-08-26T03:53:00.186822Z â€” assistant</h2>
<h2 id="2025-08-26t035332077000z-user">2025-08-26T03:53:32.077000Z â€” user</h2>
<p>can you make me an index.html file for https://s3.omniversalaether.app so that I can just go straight to the domain and browse all of the r2 files?</p>
<h2 id="2025-08-26t035333194606z-system">2025-08-26T03:53:33.194606Z â€” system</h2>
<h2 id="2025-08-26t035333240036z-assistant">2025-08-26T03:53:33.240036Z â€” assistant</h2>
<p>Got it â€” you want a simple <strong>directory index</strong> for your Cloudflare R2 bucket at <code>https://s3.omniversalaether.app</code>.  </p>
<p>âš ï¸ Important context:<br />
- R2 is S3-compatible storage, but <strong>it doesnâ€™t automatically serve directory listings</strong>. If you just point a custom domain (like <code>s3.omniversalaether.app</code>) to your bucket, youâ€™ll only be able to directly load files by their path (e.g., <code>â€¦/myfile.json</code>), not browse the whole bucket.<br />
- To get a â€œfile browserâ€ feel, you need a static HTML app that calls the <strong>R2 List Objects API</strong> (or any S3-compatible â€œListObjectsV2â€ request), then renders links. That HTML must run in the browser with valid credentials (signed URL / presigned request) or via a serverless worker proxy.  </p>
<p>Hereâ€™s a <strong>bare-bones <code>index.html</code></strong> that uses client-side JavaScript + Cloudflareâ€™s public R2 endpoint to show all objects if you expose them via a <strong>public bucket policy</strong> or a <strong>Cloudflare Worker that lists objects</strong>:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Omniversal S3 Browser&lt;/title&gt;
  &lt;style&gt;
    body { font-family: sans-serif; padding: 2em; }
    h1 { margin-bottom: 1em; }
    ul { list-style: none; padding-left: 0; }
    li { margin: 0.5em 0; }
    a { text-decoration: none; color: blue; }
    a:hover { text-decoration: underline; }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Files in Omniversal S3&lt;/h1&gt;
  &lt;ul id=&quot;file-list&quot;&gt;&lt;/ul&gt;

  &lt;script&gt;
    async function loadFiles() {
      // âš ï¸ Replace with your own Worker endpoint that calls R2 ListObjects
      const response = await fetch(&quot;/list&quot;);
      if (!response.ok) {
        document.getElementById(&quot;file-list&quot;).innerText = &quot;Failed to load file list.&quot;;
        return;
      }
      const data = await response.json();
      const ul = document.getElementById(&quot;file-list&quot;);

      data.objects.forEach(obj =&gt; {
        const li = document.createElement(&quot;li&quot;);
        const link = document.createElement(&quot;a&quot;);
        link.href = obj.url;
        link.innerText = obj.key;
        li.appendChild(link);
        ul.appendChild(li);
      });
    }
    loadFiles();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="how-to-make-this-work">How to make this work</h3>
<ol>
<li><strong>Set up a Cloudflare Worker (proxy)</strong>  </li>
<li>The Worker should call the R2 S3 ListObjectsV2 API for your bucket (<code>bucket.list()</code> in Workers API) and return JSON like:
     <code>json
     { "objects": [
       {"key": "file1.txt", "url": "https://s3.omniversalaether.app/file1.txt"},
       {"key": "folder/file2.jpg", "url": "https://s3.omniversalaether.app/folder/file2.jpg"}
     ]}</code></li>
<li>
<p>This avoids exposing credentials in the browser.</p>
</li>
<li>
<p><strong>Host <code>index.html</code></strong> at the root of your domain (<code>s3.omniversalaether.app</code>) so that visiting it runs the script, calls <code>/list</code>, and shows clickable links.</p>
</li>
<li>
<p><strong>Alternative (super simple, no JS)</strong><br />
   If you just want a static listing, you canâ€™t get it directly from R2 unless you <strong>generate the HTML yourself</strong> (via a script or Worker that enumerates and renders the bucket). Cloudflare wonâ€™t give you a default Apache-style index page.</p>
</li>
</ol>
<hr />
<p>ğŸ‘‰ Question for you: do you want me to<br />
- <strong>(a)</strong> give you the Worker script that lists your R2 files and pairs with this <code>index.html</code>,<br />
or<br />
- <strong>(b)</strong> generate a static HTML index of everything currently in your bucket (but youâ€™d need to regenerate it when files change)?  </p>
<p>That determines whether you get a <strong>live browser</strong> vs. a <strong>snapshot listing</strong>. Which way do you want to go?</p>
<h2 id="2025-08-26t035333468250z-system">2025-08-26T03:53:33.468250Z â€” system</h2>
</body>
</html>